<!DOCTYPE html>
<html>
<head>
    <title>Todo List</title>
</head>
<body>
    <h1>My Todo List</h1>
    <a href="{% url 'todo_create' %}">Add Task</a>
    <form method="get" id="filterForm">
        <label>
            <input type="radio" name="filter" value="all" {% if request.GET.filter == "all" %}checked{% endif %}>
            Show All
        </label>
        <label>
            <input type="radio" name="filter" value="completed" {% if request.GET.filter == "completed" or not request.GET.filter %}checked{% endif %}>
            Completed
        </label>
        <label>
            <input type="radio" name="filter" value="not_completed" {% if request.GET.filter == "not_completed" %}checked{% endif %}>
            Not Completed
        </label>
    </form>
    <p>Number of todos: {{ todos|length }}</p>
    <ul>
        {% for todo in todos %}
            <li>
                <strong>{{ todo.task_name }}</strong>
                {% if todo.is_completed %}
                    (Completed)
                {% else %}
                    (Not Completed)
                {% endif %}
                <br>
                {{ todo.task_description|default:"No description" }}
                <br>
                <a href="{% url 'todo_update' todo.pk %}">Edit</a> |
                <a href="{% url 'todo_delete' todo.pk %}">Delete</a>
            </li>
        {% empty %}
            <li>No tasks yet.</li>
        {% endfor %}
    </ul>

    <script>
        document.querySelectorAll('input[name="filter"]').forEach((radio) => {
            radio.addEventListener('change', () => {
                document.getElementById('filterForm').submit();
            });
        });
    </script>
</body>
</html>
